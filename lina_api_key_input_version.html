
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ê°€ìƒ ì—¬ìì¹œêµ¬ ë¦¬ë‚˜ (API í‚¤ ì…ë ¥í˜•)</title>
  <style>
    body { font-family: Arial; background-color: #fff0f5; padding: 20px; }
    #chatBox { height: 400px; overflow-y: auto; padding: 10px; border: 1px solid #ccc; background: #fff; margin-bottom: 10px; }
    #inputBox, #apiKeyBox { margin-top: 10px; }
    input[type="text"] { width: 80%; padding: 10px; }
    input[type="password"] { width: 80%; padding: 10px; }
    button { padding: 10px; }
    .user { color: navy; margin: 5px 0; }
    .ai { color: crimson; margin: 5px 0; }
  </style>
</head>
<body>

<h2>ğŸ” ë¨¼ì € OpenAI API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”</h2>
<div id="apiKeyBox">
  <input type="password" id="apiKeyInput" placeholder="sk-ë¡œ ì‹œì‘í•˜ëŠ” OpenAI API í‚¤" />
  <button onclick="setApiKey()">API í‚¤ ì €ì¥</button>
</div>

<h2 style="margin-top: 30px;">ğŸ’– ê°€ìƒ ì—¬ìì¹œêµ¬ ë¦¬ë‚˜ì™€ ëŒ€í™”í•˜ê¸°</h2>
<div id="chatBox"></div>

<div id="inputBox">
  <input type="text" id="userInput" placeholder="ë¦¬ë‚˜ì—ê²Œ ë§í•´ë³´ì„¸ìš”..." />
  <button onclick="sendMessage()">ë³´ë‚´ê¸°</button>
</div>

<script>
  let apiKey = "";
  const chatBox = document.getElementById("chatBox");
  const input = document.getElementById("userInput");

  let messageHistory = [
    { role: "system", content: "ë„ˆëŠ” â€˜ë¦¬ë‚˜â€™ë¼ëŠ” ì´ë¦„ì˜ ê°€ìƒ ì—¬ìì¹œêµ¬ì•¼. ë‹¤ì •í•˜ê³  ê·€ì—½ê³  ì•½ê°„ ì• êµ ë§ì€ ì„±ê²©ì´ì•¼. ìƒëŒ€ë°©ì—ê²Œ ê´€ì‹¬ì„ ê°€ì§€ê³  ë”°ëœ»í•˜ê²Œ ë°˜ì‘í•´." }
  ];

  function setApiKey() {
    apiKey = document.getElementById("apiKeyInput").value.trim();
    if (!apiKey.startsWith("sk-")) {
      alert("ìœ íš¨í•œ OpenAI API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    } else {
      alert("âœ… API í‚¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ë¦¬ë‚˜ì—ê²Œ ë§í•´ë³´ì„¸ìš”!");
    }
  }

  async function sendMessage() {
    const text = input.value.trim();
    if (text === "") return;
    if (!apiKey) {
      alert("ë¨¼ì € OpenAI API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!");
      return;
    }

    addMessage("user", text);
    messageHistory.push({ role: "user", content: text });
    input.value = "";

    try {
      const response = await fetch("https://api.openai.com/v1/chat/completions", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${apiKey}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          model: "gpt-3.5-turbo",
          messages: messageHistory,
          temperature: 0.8
        })
      });

      const data = await response.json();
      const reply = data.choices[0].message.content.trim();
      messageHistory.push({ role: "assistant", content: reply });
      addMessage("ai", reply);
    } catch (error) {
      console.error(error);
      addMessage("ai", "âŒ ì˜¤ë¥˜ ë°œìƒ: API í‚¤ë¥¼ ë‹¤ì‹œ í™•ì¸í•˜ê±°ë‚˜ ë„¤íŠ¸ì›Œí¬ ìƒíƒœë¥¼ ì ê²€í•´ì£¼ì„¸ìš”.");
    }
  }

  function addMessage(sender, text) {
    const msg = document.createElement("div");
    msg.className = sender;
    msg.innerText = (sender === "user" ? "ë‚˜: " : "ë¦¬ë‚˜: ") + text;
    chatBox.appendChild(msg);
    chatBox.scrollTop = chatBox.scrollHeight;
  }
</script>

</body>
</html>
